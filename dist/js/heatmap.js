var margin={top:30,right:0,bottom:0,left:100},width=$("#heatmap").width()-margin.left-margin.right,height=700-margin.top-margin.bottom,textSize=60;gridSize=Math.floor(height/25),legendElementWidth=2*gridSize,times=["02:00","04:00","06:00","08:00","10:00","12:00","14:00","16:00","18:00","20:00","22:00","24:00"],opacityRange=[.5,1],colorInterpolate=d3.interpolateRgb;var color=d3.scale.linear().range(["#367F7E","#83FFE4"]).interpolate(colorInterpolate),opacity=d3.scale.linear().range(opacityRange),svg=d3.select("#heatmap").append("svg").attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).append("g").attr("transform","translate("+margin.left+","+margin.top+")"),timeLabels=svg.selectAll(".timeLabel").data(times).enter().append("text").text(function(t){return t}).attr("y",0).attr("x",function(t,e){return e*textSize+24}).style("text-anchor","middle").attr("transform","translate("+textSize+", 0)").attr("class",function(t,e){return e>=7&&e<=16?"timeLabel mono axis axis-worktime":"timeLabel mono axis"}),heatmapChart=function(t){var e=color.domain([0,d3.max(t,function(t){return t.value})]),a=opacity.domain([1,d3.max(t,function(t){return t.value})]),r=svg.selectAll(".hour").data(t,function(t){return t.day+":"+t.hour});r.append("title"),r.enter().append("rect").attr("x",function(t){return+t.hour/2*textSize}).attr("y",function(t){return(t.day-1)*gridSize+12}).attr("class","hour bordered").attr("width",textSize).attr("height",gridSize).style("fill",color[0]),r.transition().duration(1e3).style("fill",function(t){return e(t.value)}).style("fill-opacity",function(t){return a(t.value)}),r.exit().remove()},drawDayLable=function(t){svg.selectAll(".dayLabel").data(t).enter().append("text").text(function(t){return t}).attr("x",0).attr("y",function(t,e){return e*gridSize+12}).style("text-anchor","end").attr("transform","translate(50, "+gridSize/1.5+")").attr("class",function(t,e){return e>=0&&e<=4?"dayLabel mono axis axis-workweek":"dayLabel mono axis"})};