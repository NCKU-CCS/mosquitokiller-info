!function(){var o=location.search.split("?")[1],t="https://mosquitokiller.csie.ncku.edu.tw/apis/counts?formatBy=hour&lampHashID="+o+"&limit=7",e="https://mosquitokiller.csie.ncku.edu.tw/apis/lamps/"+o+"?key=hash",a="https://mosquitokiller.csie.ncku.edu.tw/apis/counts?formatBy=date&lampHashID="+o+"&limit=1",s="https://mosquitokiller.csie.ncku.edu.tw/apis/counts?lampHashID="+o+"&limit=1";$.ajax({type:"get",url:t,crossDomain:!0,contentType:"application/json",success:function(t){var e=[],a=[],o=1;for(var s in t){for(var n=2;n<25;n+=2)t[s].hasOwnProperty(n)&&t[s].hasOwnProperty(n-1)?e.push({value:+(t[s][n].sum+t[s][n].sum),date:s.replace("2017-",""),day:+o,hour:+n}):e.push({value:0,date:s.replace("2017-",""),day:+o,hour:+n});o++,a.push(s.replace("2017-",""))}drawDayLable(a),heatmapChart(e)},error:function(t){console.log(t)}});$.ajax({type:"get",url:e,crossDomain:!0,contentType:"application/json",success:function(t){console.log(t),t.id=o,initMap(t)},fail:function(t){console.log(t)}}),$.ajax({type:"get",url:a,crossDomain:!0,contentType:"application/json",success:function(t){var e=new Date,a=e.getMonth()<9?"0":"";e.setDate(e.getDate()-1),$("#yesterdayData").text(t[e.getFullYear()+"-"+a+(e.getMonth()+1)+"-"+("00"+e.getDate()).slice(-2)][o].sum)},fail:function(t){console.log(t)}}),$.ajax({type:"get",url:s,crossDomain:!0,contentType:"application/json",success:function(t){$("#lastDate").text(t[0].created_at.replace(/T\S*/g,""))},fail:function(t){console.log(t)}})}();